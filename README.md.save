# MNIST Classification (WSL + GPU + TensorFlow)

# MNIST Classification (TensorFlow + FastAPI)

<p align="center">
  <img src="docs/img/mnist_banner.png" width="600" alt="MNIST classification banner">
</p>

<p align="center">
  <a href="https://www.python.org/">
    <img src="https://img.shields.io/badge/python-3.10%2B-blue.svg" alt="Python 3.10+">
  </a>
  <a href="https://www.tensorflow.org/">
    <img src="https://img.shields.io/badge/TensorFlow-2.x-ff6f00.svg" alt="TensorFlow">
  </a>
  <a href="https://fastapi.tiangolo.com/">
    <img src="https://img.shields.io/badge/FastAPI-ready-009688.svg" alt="FastAPI">
  </a>
  <a href="https://hub.docker.com/">
    <img src="https://img.shields.io/badge/docker-containerized-2496ED.svg" alt="Docker">
  </a>
  <a href="https://github.com/karimladha1/mnist_classification/actions">
    <img src="https://img.shields.io/badge/tests-pytest-green.svg" alt="Tests: pytest">
  </a>
  <a href="LICENSE">
    <img src="https://img.shields.io/badge/license-MIT-green.svg" alt="License: MIT">
  </a>
</p>

---

## Overview

This project implements a **handwritten digit classifier** on the **MNIST dataset** using
TensorFlow/Keras. It includes:

- A clean, reusable ML project structure
- Training, evaluation, and prediction scripts
- JSON logging of metrics per run (`data/metrics/`)
- Optional **FastAPI** service for online inference
- A **Dockerfile** to containerize the API
- Tests and hooks to support a professional development workflow

The goal is to serve as a **template for future ML projects** as well as a
concrete, working MNIST example.

---

## Project Structure

```text
mnist_classification/
│
├── src/                              # Core source code
│   ├── main.py                       # Training entrypoint (logs metrics to JSON)
│   ├── utils.py                      # Config, logging, metrics helpers
│   └── api_fastapi.py                # (optional) FastAPI inference service
│
├── notebooks/                        # Jupyter notebooks for exploration
│
├── data/                             # Datasets
│   ├── raw/                          # Original data
│   ├── processed/                    # Preprocessed datasets
│   └── metrics/                      # JSON metrics saved per training run
│
├── models/                           # Saved model weights / artifacts
│
├── reports/                          # Plots, figures, notes
│
├── tests/                            # Pytest unit tests
│
├── docs/                             # Documentation site + assets
│   ├── index.md                      # MkDocs home page
│   ├── getting-started.md            # Installation / usage
│   ├── api.md                        # API & CLI docs
│   └── img/
│       └── mnist_banner.png          # README banner image
│
├── config.yaml                       # Training / path configuration
├── requirements.txt                  # Python dependencies
├── Dockerfile                        # Container for FastAPI service
├── Makefile                          # Convenience commands (train, test, serve)
├── .gitignore                        # Ignore unnecessary files
└── README.md                         # Project documentation




# Getting Started Environment Setup

Prerequisites
WSL2 with Ubuntu 22.04
Python 3.10+
NVIDIA driver + CUDA toolkit (host)
VS Code with Remote WSL + Python extensions
Git with SSH keys configured

# 1 Clone the repository
git clone git@github.com:karimladha1/mnist_classification.git
cd mnist_classification

# 2 Create and activate venv (inside WSL)
python3.10 -m venv .venv
source .venv/bin/activate         # Linux/WSL/macOS
# .venv\Scripts\activate          # Windows PowerShell


# 3 Install dependencies
pip install -r requirements.txt

# 4 GPU Support

# Configuration: Training and paths are controlled by config.yaml. Example fields:
# Change these values to run different experiments (epochs, batch size, etc.).
seed: 42
data:
  raw_dir: data/raw
  processed_dir: data/processed
  metrics_dir: data/metrics
training:
  batch_size: 128
  epochs: 10
  learning_rate: 0.001
  validation_split: 0.1
model:
  type: simple_cnn
  save_dir: models
logging:
  metrics_to_console: true





# Setup
# Clone
git clone git@github.com:karimladha1/mnist_classification.git
cd mnist_classification

# Create and activate virtual environment venv (inside WSL)
python3 -m venv .venv
source .venv/bin/activate

# Install dependencies
pip install -r requirements.txt


# --> Training the Model
# Quick run from project root with .venv activated
# this will load the dataset, train the model, save metrics

make train
# or
python src/main.py

After each run, metrics are written to:
data/metrics/metrics_<run_name>_<timestamp>.json

You can customize training settings in config.yaml:
training:
  epochs: 5
  batch_size: 64
  validation_split: 0.1
paths:
  models_dir: "models"
  logs_dir: "logs"
  metrics_dir: "data/metrics"
  run_name: "run_1"

Testing
make test
# or
pytest

# --> Serving with FastAPI
# 1. Start FastAPI server
uvicorn api.main:app --reload
# 2. API available at:
http://127.0.0.1:8000
# 3. Example JSON request
{
    "image_base64": "<base64-encoded image>"
}


Implement src/api_fastapi.py with a FastAPI app called app.
Example:
from fastapi import FastAPI
import tensorflow as tf

app = FastAPI(title="MNIST Classifier")

# TODO: load your trained model here
model = None

@app.get("/health")
def health():
    return {"status": "ok"}

@app.post("/predict")
def predict(payload: dict):
    # TODO: preprocess input and run model.predict
    return {"prediction": None}

Run Locally
uvicorn src.api_fastapi:app --host 0.0.0.0 --port 8000

# --> Docker
# 1. Build Docker image
docker build -t ml_project .

# 2. Run the container

uvicorn src.api_fastapi:app --host 0.0.0.0 --port 8000
Run:
docker run -p 8000:8000 mnist-classification-api
The API will be available at http://localhost:8000.

# --> Development workflow
# 0. Create branches for new features
git checkout -b feature/new-model

Typical loop:
# 1. Make code changes
# 2. Run tests
make test

# 3. Run training / experiment
make train

# 3.5 Format code
black src
isort src
flake8 src


# 4. Commit and push changes
git add .
git commit -m "Describe your change"
git push


# --> License
TBD (MIT / Apache-2.0 / etc.)
See LICENSE file for details


